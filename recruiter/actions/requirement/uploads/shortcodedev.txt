<?php
 function create_courses_recently_added() { $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = strtolower(esc_html( $current_user->user_email )); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) ) ){ ?>
	
	<p class="courseCat">Recently Added</p>
	<div class="owl-1 owl-carousel owl-theme">
	<?php
 ob_start(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'date_query' => array( array( 'after' => '-6 month', ), ), 'meta_query' => array( array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'key' => 'require_special_permissions', 'value' => '1', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ) ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); if( $require_special_permissions == '1' ){ $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); if($result){ ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; } elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } }elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php }} endwhile; wp_reset_postdata(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'date_query' => array( array( 'after' => '-6 month', ), ), 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ), array( 'relation' => 'OR', array( 'key' => 'course_category', 'value' => 'AO', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'PD', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'IN', 'compare' => 'LIKE' ), ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; } elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; wp_reset_postdata(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'key' => 'recently_added', 'value' => 'yes', 'compare' => 'LIKE' ), array( 'key' => 'require_special_permissions', 'value' => '0', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; wp_reset_postdata(); $content = ob_get_clean(); return $content; ?>
	</div>

<?php
 } } function create_courses_recently_added_new() { $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = strtolower(esc_html( $current_user->user_email )); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) ) ){ ?>
	
	<p class="courseCat">Recently Added</p>
	<div class="owl-1 owl-carousel owl-theme">
	<?php
 ob_start(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'key' => 'recently_added', 'value' => 'yes', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ) ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); if( $require_special_permissions == '1' ){ $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); if($result){ ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; } elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } }elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php }} endwhile; wp_reset_postdata(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ), array( 'key' => 'recently_added', 'value' => 'yes', 'compare' => 'LIKE' ), array( 'relation' => 'OR', array( 'key' => 'course_category', 'value' => 'AO', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'PD', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'IN', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'PP', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'CA', 'compare' => 'LIKE' ), ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; } elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; wp_reset_postdata(); ?>
	 


<?php
 } } add_shortcode( 'courses_recently_added', 'create_courses_recently_added_new' ); function create_courses_professional_development() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'PD', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) ) ){ ?>
	
	<p class="courseCat">Professional Development</p>
	<div class="owl-2 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_professional_development', 'create_courses_professional_development' ); function create_courses_associate_orientation() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'AO', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) ) ){ ?>
	
	<p class="courseCat">Associate Orientation</p>
	<div class="owl-3 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_associate_orientation', 'create_courses_associate_orientation' ); function create_courses_podcast() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'PP', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) ) ){ ?>
	
	<p class="courseCat">Presentations and Podcasts</p>
	<div class="owl-6 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_podcast', 'create_courses_podcast' ); function create_courses_smaResources() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SR', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) ) ){ ?>
	
	<p class="courseCat">SMA Resources</p>
	<div class="owl-6 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_smaResources', 'create_courses_smaResources' ); function create_courses_skills_assesment() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'candidate', 'compare' => 'LIKE' ) ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentusername = esc_html($current_user->user_login); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['PermissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['PermissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } $permisscount = count($body[permission]); if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) || ($checkUserType == 4) || ($checkUserType == 7) || ($permisscount == 0 ) ) ) { ?>
	
		<p class="courseCat">Skills Assessment</p>
		<div class="owl-4 owl-carousel owl-theme">
		<?php
 $inopermissionMatch = 0; while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); if($SelectField == 1){ $no_video = true; } if($SelectField=='1' && !empty($SelectField) ) { $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); if( $require_special_permissions == '1' ){ $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content <?php if( (empty(count($result))) && (($checkUserType == 4) || ($checkUserType == 7)) ){ echo 'locked-course';} ?>" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
								<div style="height: 85px; line-height: 85px; text-align: center; ">
									<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;">
									<?php the_title(); ?>
									</p>	
								</div>

								<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
								<p  class="titleinfo" style="margin-bottom: 5px;font-size: 12px;color: #fff;">
								<span><?php echo $labeltypeOfLearning; ?></span> | 
								<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
									<?php if( $certificateCourse == '1' ){ ?>
									<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
									<?php } ?>
								</p>
								</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content <?php if( (empty(count($result))) && (($checkUserType == 4) || ($checkUserType == 7)) ){ echo 'locked-course';} ?>" 
						style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<?php if( (empty(count($result))) && (($checkUserType == 4) || ($checkUserType == 7)) ){ echo '<div class="lockedCourse"><button id="permissionbtn" data-ajax="'.admin_url('admin-ajax.php').'" data-title="'.get_the_title().'" data-email="'.$currentUserEmail.'" data-user="'.$currentusername.'" type="submit">Get Authorization</button></div>';} ?>
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
			 <?php  } endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
		</div>
	
			<?php
 } else { echo '<p class="courseCat">Skills Assessment</p><div class="owl-4 owl-carousel owl-theme">'; while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); if($SelectField == 1){ $no_video = true; } if($SelectField=='1' && !empty($SelectField) ) { $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content else <?php if( empty(count($result)) ){ echo 'locked-course';} ?>" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement3" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
								<div style="height: 85px; line-height: 85px; text-align: center; ">
									<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;">
									<?php the_title(); ?>
									</p>	
								</div>

								<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
								<p  class="titleinfo" style="margin-bottom: 5px;font-size: 12px;color: #fff;">
								<span><?php echo $labeltypeOfLearning; ?></span> | 
								<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
									<?php if( $certificateCourse == '1' ){ ?>
									<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
									<?php } ?>
								</p>
								</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content <?php if( empty(count($result)) ){ echo 'locked-course';} ?>" 
						style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<?php if( empty(count($result)) ){ echo '<div class="lockedCourse"><button id="permissionbtn" data-ajax="'.admin_url('admin-ajax.php').'" data-title="'.get_the_title().'" data-email="'.$currentUserEmail.'" data-user="'.$currentusername.'" type="submit">Get Authorization</button></div>';} ?>
						<a id="skill_assement4" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
			 <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; echo '</div>'; } } add_shortcode( 'courses_skills_assesment', 'create_courses_skills_assesment' ); function create_courses_client() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'PD', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($usertype == 'Client') || ($isClient) ) ){ ?>
	
	<p class="courseCat">Professional Development</p>
	<div class="owl-5 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_client', 'create_courses_client' ); function create_courses_clientpp() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'PP', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($usertype == 'Client') || ($isClient) ) ){ ?>
	
	<p class="courseCat">Presentations & Podcasts</p>
	<div class="owl-3 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_clientpp', 'create_courses_clientpp' ); function create_client_courses_skills_assesment() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentusername = esc_html($current_user->user_login); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } $permisscount = count($body[permission]); if( ($currentUserEmail == $checkUserEmail) && ( ($usertype == 'Client') || ($isClient) ) ){ ?>
	
		<p class="courseCat">Client Skills Assessment</p>
		<div class="owl-4 owl-carousel owl-theme">
		<?php
 $inopermissionMatch = 0; while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); if($SelectField == 1){ $no_video = true; } if($SelectField=='1' && !empty($SelectField) ) { $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); if( $require_special_permissions == '1' ){ $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content <?php// if( empty(count($result)) ){ echo 'locked-course';} ?>" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
								<div style="height: 85px; line-height: 85px; text-align: center; ">
									<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;">
									<?php the_title(); ?>
									</p>	
								</div>

								<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
								<p  class="titleinfo" style="margin-bottom: 5px;font-size: 12px;color: #fff;">
								<span><?php echo $labeltypeOfLearning; ?></span> | 
								<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
									<?php if( $certificateCourse == '1' ){ ?>
									<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
									<?php } ?>
								</p>
								</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content <?php// if( empty(count($result)) ){ echo 'locked-course';} ?>" 
						style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<?php  ?>
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
			 <?php  } endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
		</div>
	
			<?php
 } else { echo '<p class="courseCat">Skills Assessment</p><div class="owl-4 owl-carousel owl-theme">'; while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); if($SelectField == 1){ $no_video = true; } if($SelectField=='1' && !empty($SelectField) ) { $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content <?php if( empty(count($result)) ){ echo 'locked-course';} ?>" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement3" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
								<div style="height: 85px; line-height: 85px; text-align: center; ">
									<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;">
									<?php the_title(); ?>
									</p>	
								</div>

								<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
								<p  class="titleinfo" style="margin-bottom: 5px;font-size: 12px;color: #fff;">
								<span><?php echo $labeltypeOfLearning; ?></span> | 
								<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
									<?php if( $certificateCourse == '1' ){ ?>
									<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
									<?php } ?>
								</p>
								</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content <?php// if( empty(count($result)) ){ echo 'locked-course';} ?>" 
						style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<?php if( empty(count($result)) ){ echo '<div class="lockedCourse"><button id="permissionbtn" data-ajax="'.admin_url('admin-ajax.php').'" data-title="'.get_the_title().'" data-email="'.$currentUserEmail.'" data-user="'.$currentusername.'" type="submit">Get Authorization</button></div>';} ?>
						<a id="skill_assement4" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
			 <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; echo '</div>'; } } add_shortcode( 'courses_client_skill_assesment', 'create_client_courses_skills_assesment' ); function create_client_courses_recently_added() { $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = strtolower(esc_html( $current_user->user_email )); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; $isClient = $body['typelist']['0']['isClient']; $isAssociate = $body['typelist']['0']['isAssociate']; $isCandidate = $body['typelist']['0']['isCandidate']; $currentRole = $body['typelist']['0']['currentRole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($usertype == 'Client') || ($isClient) ) ){ ?>
	
	<p class="courseCat">Recently Added</p>
	<div class="owl-1 owl-carousel owl-theme">
	<?php
 ob_start(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'date_query' => array( array( 'after' => '-6 month', ), ), 'meta_query' => array( array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'key' => 'require_special_permissions', 'value' => '1', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ) ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); if( $require_special_permissions == '1' ){ $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); if($result){ ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; } elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } }elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php }} endwhile; wp_reset_postdata(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'date_query' => array( array( 'after' => '-6 month', ), ), 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ), array( 'relation' => 'OR', array( 'key' => 'course_category', 'value' => 'PP', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'PD', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'IN', 'compare' => 'LIKE' ), ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; } elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; wp_reset_postdata(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'key' => 'recently_added', 'value' => 'yes', 'compare' => 'LIKE' ), array( 'key' => 'require_special_permissions', 'value' => '0', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; wp_reset_postdata(); $content = ob_get_clean(); return $content; ?>
	</div>

<?php
 } } function create_client_courses_recently_added_new() { $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = strtolower(esc_html( $current_user->user_email )); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($usertype == 'Client') || ($isClient) ) ){ ?>
	
	<p class="courseCat">Recently Added</p>
	<div class="owl-1 owl-carousel owl-theme">
	<?php
 ob_start(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'key' => 'recently_added', 'value' => 'yes', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ) ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); if( $require_special_permissions == '1' ){ $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); if($result){ ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; } elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } }elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php }} endwhile; wp_reset_postdata(); $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ), array( 'key' => 'recently_added', 'value' => 'yes', 'compare' => 'LIKE' ), array( 'relation' => 'OR', array( 'key' => 'course_category', 'value' => 'AO', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'PD', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'IN', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'PP', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'CA', 'compare' => 'LIKE' ), ) ) ); $loop = new WP_Query( $args ); while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; } elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; wp_reset_postdata(); ?>
	 


<?php
 } } add_shortcode( 'courses_client_RecentlyAdded', 'create_client_courses_recently_added_new' ); function create_courses_smaInspiration() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'IN', 'compare' => 'LIKE' ), array( 'relation' => 'OR', array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'candidate', 'compare' => 'LIKE' ) ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) || ($checkUserType == 4) || ($checkUserType == 7) ) ){ ?>
	
	<p class="courseCat">Inspiration</p>
	<div class="owl-7 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_smaInspiration', 'create_courses_smaInspiration' ); function create_courses_clientInspiration() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'IN', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($usertype == 'Client') || ($isClient) ) ){ ?>
	
	<p class="courseCat">Inspiration</p>
	<div class="owl-8 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_clientInspiration', 'create_courses_clientInspiration' ); function create_courses_clientInspiration_public() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'IN', 'compare' => 'LIKE' ), array( 'key' => 'public_course', 'value' => 'yes', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } ?>
	
	<p class="courseCat">Inspiration</p>
	<div class="owl-8 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=public_ins&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=public_ins&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } add_shortcode( 'courses_clientInspiration_public', 'create_courses_clientInspiration_public' ); function create_cpablty_Assessment() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ), array( 'key' => 'course_category', 'value' => 'CA', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($usertype == 'Client') || ($isClient) ) ){ ?>
	
	<p class="courseCat">Capability Assessment</p>
	<div class="owl-10 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<?php  global $wpdb; $survey_tb = $wpdb->prefix . "survey_progression"; $userid = $user->ID; $postID = $ID; $survey_url = $wpdb->get_results("SELECT * FROM $survey_tb	WHERE user_id = $userid AND course_id = $postID AND  module_status = 'inProgress' ORDER BY ID ASC LIMIT 1"); $wpdb->show_errors( true ); if($survey_url){ $module = $survey_url[0]->module_id; ?>	
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=<?php echo $module; ?>"> 
					<?php	}else{ ?>
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<?php } ?>	
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: 1;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_cpablty_Assessment', 'create_cpablty_Assessment' ); function create_cpablty_Assessment_public() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'CA', 'compare' => 'LIKE' ), array( 'key' => 'public_course', 'value' => 'yes', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } ?>
	
	<p class="courseCat">Capability Assessment</p>
	<div class="owl-10 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $public_module_no = get_field('public_module_no'); $timesum = 0; $no_video = false; $aud_len =""; $checkPublic =""; $inc =0; if( have_rows('module') ): while( have_rows('module') ): the_row(); $inc++; $public_module = get_sub_field('public_module'); if($public_module == 'yes'){ $checkPublic = true; $vval[] = $inc; } if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=public_ins&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<?php  global $wpdb; $survey_tb = $wpdb->prefix . "survey_progression"; $userid = $user->ID; $postID = $ID; $survey_url = $wpdb->get_results("SELECT * FROM $survey_tb	WHERE user_id = $userid AND course_id = $postID AND  module_status = 'inProgress' ORDER BY ID ASC LIMIT 1"); $wpdb->show_errors( true ); if($survey_url){ $module = $survey_url[0]->module_id; ?>	
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=public_ins&courseID=<?php echo $ID; ?>&module=<?php if($checkPublic){ echo $vval[0];} ?>"> 
					<?php	}else{ ?>
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=public_ins&courseID=<?php echo $ID; ?>&module=<?php if($checkPublic){ echo $vval[0];} ?>">
						<?php } ?>	
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: 1;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } add_shortcode( 'courses_cpablty_Assessment_public', 'create_cpablty_Assessment_public' ); function create_courses_professional_development_public() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'PD', 'compare' => 'LIKE' ), array( 'key' => 'public_course', 'value' => 'yes', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } ?>
	
	<p class="courseCat">Professional Development</p>
	<div class="owl-2 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } add_shortcode( 'courses_professional_development_public', 'create_courses_professional_development_public' ); function create_courses_associate_orientation_public() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'AO', 'compare' => 'LIKE' ), array( 'key' => 'public_course', 'value' => 'yes', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } ?>
	
	<p class="courseCat">Associate Orientation</p>
	<div class="owl-3 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } add_shortcode( 'courses_associate_orientation_public', 'create_courses_associate_orientation_public' ); function create_courses_podcast_public() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'PP', 'compare' => 'LIKE' ), array( 'key' => 'public_course', 'value' => 'yes', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } ?>
	
	<p class="courseCat">Presentations and Podcasts</p>
	<div class="owl-6 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> | 
							<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } add_shortcode( 'courses_podcast_public', 'create_courses_podcast_public' ); function create_client_courses_skills_assesment_public() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'SA', 'compare' => 'LIKE' ), array( 'key' => 'public_course', 'value' => 'yes', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentusername = esc_html($current_user->user_login); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } $permisscount = count($body[permission]); ?>
	
		<p class="courseCat">Skills Assessment</p>
		<div class="owl-4 owl-carousel owl-theme">
		<?php
 $inopermissionMatch = 0; while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); if($SelectField == 1){ $no_video = true; } if($SelectField=='1' && !empty($SelectField) ) { $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $require_special_permissions = get_field('require_special_permissions'); if( $require_special_permissions == '1' ){ $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content <?php// if( empty(count($result)) ){ echo 'locked-course';} ?>" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
								<div style="height: 85px; line-height: 85px; text-align: center; ">
									<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;">
									<?php the_title(); ?>
									</p>	
								</div>

								<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
								<p  class="titleinfo" style="margin-bottom: 5px;font-size: 12px;color: #fff;">
								<span><?php echo $labeltypeOfLearning; ?></span> | 
								<span><?php
 if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span> 
									<?php if( $certificateCourse == '1' ){ ?>
									<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
									<?php } ?>
								</p>
								</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content <?php// if( empty(count($result)) ){ echo 'locked-course';} ?>" 
						style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<?php  ?>
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){$minutes = floor($timesum / 60); echo $minutes.' mins';} elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } $quizshort = explode("[watupro ",$quiz_shortcode); $quizshortcode = explode("]",$quizshort[1]); $final_quizshortcode = $quizshortcode[0]; global $wpdb; $wpdb->show_errors( true ); $results = $wpdb->get_results( "SELECT time_limit FROM wp_watupro_master WHERE ID = $final_quizshortcode "); $quiztime = $results[0]->time_limit; $t_quiztime = explode(".",$quiztime); $f_quiztime = $t_quiztime[0]; if($f_quiztime == "0"){ echo "unlimited";}else{ echo $f_quiztime.' mins';} ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
			 <?php  } endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
		</div>
	
			<?php
 } add_shortcode( 'courses_client_skill_assesment_public', 'create_client_courses_skills_assesment_public' ); function create_courses_aboutSMA_public() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'AS', 'compare' => 'LIKE' ), array( 'key' => 'public_course', 'value' => 'yes', 'compare' => 'LIKE' ) ) ); ob_start(); $loop = new WP_Query( $args ); $usertype = $_COOKIE['userType']; $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } ?>
	
	<p class="courseCat">About SMA</p>
	<div class="owl-8 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=public_ins&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=public_ins&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } add_shortcode( 'courses_aboutSMA_public', 'create_courses_aboutSMA_public' ); function create_courses_aboutSMA() { $args = array( 'post_type' => 'course', 'posts_per_page' => -1, 'meta_query' => array( 'relation' => 'AND', array( 'key' => 'course_category', 'value' => 'AS', 'compare' => 'LIKE' ), array( 'relation' => 'OR', array( 'key' => 'course_visibility', 'value' => 'associate', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'candidate', 'compare' => 'LIKE' ), array( 'key' => 'course_visibility', 'value' => 'client', 'compare' => 'LIKE' ) ) ) ); ob_start(); $loop = new WP_Query( $args ); $current_user = wp_get_current_user(); $currentUserEmail = esc_html( $current_user->user_email ); $url = API_BASE.'/Identity/api/Account/login'; $body = json_encode(array( "username"=>"APIUser", "Password"=>"Tod@123", "Email"=>"Diksha.sharma@upkarak.com" )); $request = array( 'headers' => array('Content-Type' => 'application/json;charset=utf-8',), 'body' => $body, 'method' => 'POST' ); $responsetoken = wp_remote_post( $url, $request ); $token = json_decode($responsetoken['body'], true ); $tokenb = $token['token']; $permissionUrl = API_BASE.'/LMSMicroservice/api/LMSPermissions/GetLMSUserPermissionsByEmail?Email_chr='.$currentUserEmail.'&CurrentRole_chr='.$usertype; $method2 = 'GET'; $headers2 = array( 'Authorization' => 'bearer ' .$tokenb, 'Accept' => 'application/json', 'Content-Type' => 'application/json; charset=UTF-8' ); $request2 = array( 'headers' => $headers2, 'method' => $method2, ); $response = wp_remote_request( $permissionUrl, $request2 ); if ( is_array( $response ) ) { $header = $response['headers']; $body = json_decode($response['body'], true ); } $userPermission_l = array_change_key_case($body['userPermission']['0'],CASE_LOWER); $checkUserEmail = $userPermission_l['email_chr']; $checkUserType = $userPermission_l['associatetype']; $userPermission = $body['permission']; $typelist = array_change_key_case($body['typelist']['0'],CASE_LOWER); $isClient = $typelist['isclient']; $isAssociate = $typelist['isassociate']; $isCandidate = $typelist['iscandidate']; $currentRole = $typelist['currentrole']; foreach ($userPermission as $permission) { $TODpermissions[] = array('permissionId_ids' => $permission['permissionId_ids'], 'permission_chr' => $permission['permission_chr'] ); $TODpermissionsids[] = array('permissionId_ids' => $permission['permissionId_ids'] ); $TODpermissionslabels[] = array('permission_chr' => $permission['permission_chr'] ); } foreach ($TODpermissionsids as $TODpermissionsid) { $TODpermissionsval[] = $TODpermissionsid['permissionId_ids'] ; } if( ($currentUserEmail == $checkUserEmail) && ( ($checkUserType == 1) || ($checkUserType == 5) || ($checkUserType == 4) || ($checkUserType == 7) ) ){ ?>
	
	<p class="courseCat">About SMA</p>
	<div class="owl-7 owl-carousel owl-theme">
	<?php
 while ( $loop->have_posts() ) : $loop->the_post(); $ID = get_the_ID(); $user = wp_get_current_user(); $output = $src = wp_get_attachment_image_src( get_post_thumbnail_id($ID), array( 1220,900 ), false, '' ); $filteredContent = substr(get_the_excerpt(), 0,150); $filteredContent2 = substr(get_field( "course_description" ), 0,150); $exc = get_the_excerpt(); $exc2 = get_field( "course_description" ); $showDots = strlen($exc2); $certificateCourse = get_field('certification_course'); $typeOfLearning = get_field_object('type_of_learning'); $valuetypeOfLearning = $typeOfLearning['value']; $labeltypeOfLearning = $valuetypeOfLearning['label']; $locationaddress1 = get_field('location-address1'); $locationaddress2 = get_field('location-address2'); $locationcity = get_field('location_city'); $locationstate = get_field('location_state'); $course_author = get_field('course_author'); $title_of_course_author = get_field('title_of_course_author'); $timesum = 0; $no_video = false; $aud_len =""; if( have_rows('module') ): while( have_rows('module') ): the_row(); if( have_rows('module_data') ): while( have_rows('module_data') ): the_row(); $SelectField = get_sub_field('select_option'); $video_iframe = get_sub_field('add_video_iframe'); $quiz_shortcode = get_sub_field('add_quiz_shortcode'); $audio_file = get_sub_field('add_audio'); if($SelectField == 1){ $no_video = true; } if($SelectField=='4' && !empty($SelectField) ){ $id = $audio_file['ID']; require_once( ABSPATH . 'wp-admin/includes/media.php' ); $audio_file_path = get_attached_file( $id ); $aud_len = wp_read_audio_metadata( $audio_file_path ); $in_min = $aud_len['length']/60; $t_time+= $in_min; } if($SelectField=='1' && !empty($SelectField) ){ $oembed_endpoint = 'http://vimeo.com/api/oembed'; $video_url = $video_iframe; $json_url = $oembed_endpoint . '.json?url=' . rawurlencode($video_url) ; $request = wp_remote_get( $json_url ); if( is_wp_error( $request ) ) { return false; } $body = wp_remote_retrieve_body( $request ); $data = json_decode( $body ); $init = $data->duration; $hours = floor($init / 3600); $minutes = floor(($init / 60) % 60); $timesum+= $init; } endwhile; endif; endwhile; endif; $coursePermissions = get_field('user_permissions'); $arrlength = count($coursePermissions); $coursePermissionval = array(); if ( $coursePermissions ) { foreach ($coursePermissions as $key => $coursePermission) { $coursePermissionval[] = $coursePermission['value']; } } $result = array_intersect($TODpermissionsval, $coursePermissionval); ?>
	 
				
						<div class="item" style="width:220px;" >
						<div class="content" style="background-image: url('<?php echo $output[0]; ?>');">
						<a id="skill_assement1" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1" target="_blank">
							<div class="course-title">
							<div style="height: 85px; line-height: 85px; text-align: center; ">
  								<p class="title" style="display: inline-block; vertical-align: middle; line-height: normal;"><?php the_title(); ?></p>	
							</div>
							<div style="height: 25px;line-height: 25px;padding: 0px 5px;position: relative;">
							<p style="margin-bottom: 5px;font-size: 12px;color: #fff;">
							<span><?php echo $labeltypeOfLearning; ?></span> <span style="font-size: 14px;">|</span> 
							<span>
							<?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> 
							</span> 
							<?php if( $certificateCourse == '1' ){ ?>
							<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
							<?php } ?>
							</p>
							
							</div>
							</div>
							
						</a>	
						</div>
						
						<div class="overlay-content" style="background-image: url('<?php echo $output[0]; ?>'); padding: 2px;">
						<a id="skill_assement2" href="<?php the_permalink(); ?>/?userid=<?php echo $user->ID; ?>&courseID=<?php echo $ID; ?>&module=1">
						<div class="upper-overlay" style="height: 40%;">
						
						<div style="height: 80%; line-height: 8.1; text-align: center; ">
						<p class="courseTitle"><?php the_title(); ?></p>
						</div>
						<div style="height: 20%;line-height: 20px;padding: 0px 5px;">
						<p style="margin-bottom: 5px;font-size: 12px;position: relative;color: #fff;">
						<span><?php echo $labeltypeOfLearning; ?></span> | 
						<span><?php  if($valuetypeOfLearning['value'] == 'oc'){ if(!empty($aud_len)){ $english_format_number = number_format($t_time, 2, '.', ''); echo floor($english_format_number).' mins'; }elseif($no_video == false){ echo 'Document'; }else{ $minutes = floor($timesum / 60); echo $minutes.' mins'; } } elseif($valuetypeOfLearning['value'] == 'cs'){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); echo $date2 ; }elseif( ($valuetypeOfLearning['value'] == 'se')||($valuetypeOfLearning['value'] == 'web')||($valuetypeOfLearning['value'] == 'cc') ){ $date = get_field('start_date-time_of_event'); $date2 = date("M j", strtotime($date)); $time = date("g A", strtotime($date)); echo $date2.' <span style="font-size: 14px;">|</span>  '.$time ; $timezone = get_field('time_zone'); echo ' ('.$timezone['value'].')'; } ?> </span>  
						<?php if( $certificateCourse == '1' ){ ?>
						<i class="fas fa-award" style="color:#fff;position: absolute;right: 5px;bottom: 0px;font-size: 24px;"></i>
						<?php } ?>
						</p>
						</div>
						
						</div>
						<div class="lower-overlay" style="background:#fff;height:60%;border:none;border-radius:2px;padding:10px;">
						<p style="margin-bottom: 0px;color: #000;font-size: 14px;">
						
						<span style="font-weight: 600;display: block;line-height: .5;"><?php echo $course_author; ?></span>
						<span style="display: block;line-height: 1;font-size: 13px;margin-top: 5px;font-weight: 400;"><?php echo $title_of_course_author; ?></span>
						</p>
						<?php if($valuetypeOfLearning['value'] == 'cs'){ ?>
						<p style="margin-bottom: 5px;margin-top:5px;color: #5a9443;font-size: 12px;line-height: 1.2;font-weight: 600;">
						October 12-14<br>
						<span><?php  echo $locationaddress1; if($locationcity){ echo ', '.$locationcity;} if($locationstate){ echo ', '.$locationstate;} ?></span>
						</p>
						<?php }?>
						
						<span class="description" style="
						<?php if(!$title_of_course_author){echo 'margin-top:10px;';} ?>
						
						<?php if($valuetypeOfLearning['value'] != 'cs'){echo 'margin-top:10px;';} ?>
						line-height: 1.35;display: block;width: 100%;color: #000;font-size: 12px;">
						<?php echo $filteredContent2; if($showDots >= 150){echo "...";}?>
						</span>
						
						
						<?php if( $certificateCourse == '1' ){ ?>
						<p style="margin-bottom: 0px;position: absolute;bottom: 10px;">
						<i class="fas fa-award" style="color:#5a9443;font-size:13px;"></i>
						<span style="color: #5a9443;font-size: 12px; font-weight: 700;">Certification Course<span></p>
						<?php } ?>
						
						</div>
						</a>
						</div>	
						</div>
						
				
	 
	 
				
				
   <?php  endwhile; $content = ob_get_clean(); wp_reset_postdata(); return $content; ?>
   </div>
	
   <?php
 } } add_shortcode( 'courses_aboutSMA', 'create_courses_aboutSMA' );